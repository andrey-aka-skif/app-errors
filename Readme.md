# app-errors

Npm-пакет, предоставляющий классы ошибок приложения, связанные с обращением к внешнему API и внутренней логикой.

## Классы ошибок

- `BaseAppError` - Базовый класс для ошибок приложения, расширяющий встроенный класс Error. Добавляет пользовательские свойства: тип ошибки и дополнительные детали. Класс не должен быть создан напрямую. Прочие классы ошибок наследуются от `BaseAppError`.

- `BadRequestError` - Класс ошибки "Неверный запрос" (Bad Request). Предназначен для обработки ситуаций, когда клиент отправляет некорректные данные. Статус ошибки соответствует HTTP-коду 400.

- `ConflictError` - Класс ошибки "Конфликт" (Conflict). Предназначен для обработки ситуаций, когда запрос не может быть выполнен из-за конфликта с текущим состоянием системы. Статус ошибки соответствует HTTP-коду 409.

- `CustomError` - Класс пользовательской ошибки. Позволяет создавать ошибки с произвольным типом, сообщением и дополнительными деталями.

- `DisconnectedError` - Класс ошибки, связанной с потерей соединения. Предназначен для обработки ситуаций, когда приложение теряет связь с внешними ресурсами.

- `ForbiddenError` - Класс ошибки "Доступ запрещён" (Forbidden). Предназначен для обработки ситуаций, когда пользователь авторизован, но не имеет прав на выполнение действия. Статус ошибки соответствует HTTP-коду 403.

- `InternalServerError` - Класс ошибки "Внутренняя ошибка сервера" (Internal Server Error). Предназначен для обработки ситуаций, когда сервер столкнулся с непредвиденной ошибкой, препятствующей выполнению запроса. Статус ошибки соответствует HTTP-коду 500.

- `LogicError` - Класс ошибки логики приложения. Предназначен для обработки ошибок, связанных с логическими нарушениями в работе приложения.

- `NotFoundError` - Класс ошибки "Ресурс не найден" (Not Found). Предназначен для обработки ситуаций, когда запрашиваемый ресурс отсутствует. Статус ошибки соответствует HTTP-коду 404.

- `UnauthorizedError` - Класс ошибки "Доступ запрещён" (Unauthorized). Предназначен для обработки ситуаций, когда пользователь не авторизован или у него отсутствуют права доступа. Статус ошибки соответствует HTTP-коду 401.

- `UnknownError` - Класс ошибки "Неизвестная ошибка" (Unknown Error). Предназначен для обработки ситуаций, когда тип ошибки не может быть определён или является неожиданным.

## Типы ошибок

Перечисление `ERROR_TYPE` дублирует типизированные классы и в первую очередь используется для текстовых констант поля `message`.

```js
const ERROR_TYPE = {
  /**
   * Неизвестная ошиибка
   */
  UNKNOWN: 'Unknown',
  /**
   * Пользовательская ошибка
   */
  CUSTOM: 'Custom',
  /**
   * Сервер недоступен
   */
  DISCONNECTED: 'Disconnected',
  /**
   * 400 Bad Request
   */
  BADREQUEST: 'BadRequest',
  /**
   * 401 Unauthorized
   */
  UNAUTHORIZED: 'Unauthorized',
  /**
   * 403 Forbidden
   */
  FORBIDDEN: 'Forbidden',
  /**
   * 404 Not Found
   */
  NOTFOUND: 'NotFound',
  /**
   * 409 Conflict
   */
  CONFLICT: 'Conflict',
  /**
   * 500 Internal Server Error
   */
  INTERNALSERVERERROR: 'InternalServerError',
  /**
   * Ошибка логики приложения
   */
  LOGIC: 'Logic',
}
```

## Пример использования

```js
import { fromAxios, UnauthorizedError } from '@andrey-aka-skif/app-errors'

...

try {
  const response = await axios.post('/auth/login', { credential })
} catch (error) {
  const typedError = fromAxios(error)

  if (typedError instanceof UnauthorizedError) {
    // logout или иное необходимое действие
  }
}
```

## Ссылки

- [История версий](CHANGELOG.md)
